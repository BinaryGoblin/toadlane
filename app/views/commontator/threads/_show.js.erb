<% # Clients of this partial must supply the following variables:
   # thread
   # user
   # page
   # per_page
   # Optionally, they can also supply the following variable:
   show_all ||= false
%>

$("#thread_<%= thread.id %>_div").html(
  "<%= escape_javascript(
    render :partial => 'commontator/threads/show',
           :formats => [:html],
           :locals => { :thread => thread,
                        :user => user,
                        :page => page,
                        :per_page => per_page,
                        :show_all => show_all }) %>");


var last_comment_block, last_comment_block_id;

if ($('.comment-block').find('.comment').length > 0) {
  last_comment_block = $('.comment-block').find('.comment:last');
  last_comment_block_id = last_comment_block.attr('id');
  $("body").animate({
    scrollTop: $('#' + last_comment_block_id).position().top
  }, 'fast');
} else {
  $("body").animate({
    scrollTop: $(".comment-block").position().top
  }, 'fast');
}
